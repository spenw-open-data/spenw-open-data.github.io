<head>
	<!-- Load plotly.js into the DOM -->
	<script src='https://cdn.plot.ly/plotly-3.3.0.min.js'></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js'></script>
</head>

<body>
	<div id='graph'><!-- Plotly chart will be drawn inside this DIV --></div>
	<div id='downloadLink'></div>
	
	<script>
let params = new URLSearchParams(document.location.search);
let subnum = params.get("subnum"); 

document.getElementById('downloadLink').innerHTML = "<a href='https://raw.githubusercontent.com/spenw-open-data/spenw-open-data.github.io/refs/heads/main/" + subnum + ".csv'>Download Data</a>"

d3.csv("https://raw.githubusercontent.com/spenw-open-data/spenw-open-data.github.io/refs/heads/main/" + subnum + ".csv", function(err, rows){

  function unpack(rows, key) {
  return rows.map(function(row) { return row[key]; });
}



var trace1 = {
  type: "scatter",
  mode: "lines",
  name: 'Apparent Power (VA)',
  x: unpack(rows, 'time'),
  y: unpack(rows, 'apparent_power'),
  line: {color: '#17BECF'}
}

var trace2 = {
  type: "scatter",
  mode: "lines",
  name: 'Real Power (W)',
  x: unpack(rows, 'time'),
  y: unpack(rows, 'real_power'),
  line: {color: '#7F7F7F'}
}

var data = [trace1,trace2];

var layout = {
  title: {
    text: subnum
  },
};

Plotly.newPlot('graph', data, layout, {scrollZoom: true});
})

	</script>
</body>
